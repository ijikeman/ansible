---
- name: Create Groups
  include_role:
     name: common_tasks
     tasks_from: group.yml
  with_items:
    - "{{ ARRAY_COMMON_GROUP | default([]) }}"
    - "{{ ARRAY_HOSTGROUP_GROUP | default([]) }}"

- name: Create Users
  include_role:
     name: common_tasks
     tasks_from: user.yml
  with_items:
    - "{{ ARRAY_COMMON_USER | default([]) }}"
    - "{{ ARRAY_HOSTGROUP_USER | default([]) }}"

- name: Remove and Install Packages
  include_role:
     name: common_tasks
     tasks_from: control_yum.yml
  with_items:
    - "{{ ARRAY_COMMON_CONTROL_PKG | default([]) }}"
    - "{{ ARRAY_HOSTGROUP_CONTROL_PKG | default([]) }}"

- name: Create Directories
  include_role:
     name: common_tasks
     tasks_from: mkdir.yml
  with_items:
    - "{{ ARRAY_COMMON_MKDIRS | default([]) }}"
    - "{{ ARRAY_HOSTSGROUP_MKDIRS | default([]) }}"

- name: Disable Services
  include_role:
     name: common_tasks
     tasks_from: disabled_service.yml
  with_items:
    - "{{ ARRAY_COMMON_DISABLE_SERVICE | default([]) }}"
    - "{{ ARRAY_HOSTGROUP_DISABLE_SERVICE | default([]) }}"

- name: Create Symlinks
  file:
    src: "{{ item.src }}"
    path: "{{ item.path }}"
    state: link
  with_items:
    - "{{ ARRAY_COMMON_LINKS | default([]) }}"
    - "{{ ARRAY_HOSTGROUP_LINKS | default([]) }}"
